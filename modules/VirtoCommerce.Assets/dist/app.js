!function(e){var t={};function r(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(o,a,function(t){return e[t]}.bind(null,a));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r(1),r(2),r(3),r(4),e.exports=r(5)},function(e,t){void 0!==AppDependencies&&AppDependencies.push("virtoCommerce.assetsModule"),angular.module("virtoCommerce.assetsModule",[]).config(["$stateProvider",function(e){e.state("workspace.assetsModule",{url:"/assets",templateUrl:"$(Platform)/Scripts/common/templates/home.tpl.html",controller:["$scope","platformWebApp.bladeNavigationService",function(e,t){t.showBlade({id:"assetList",controller:"virtoCommerce.assetsModule.assetListController",template:"Modules/$(VirtoCommerce.Assets)/Scripts/blades/asset-list.tpl.html",isClosingDisabled:!0})}]})}]).run(["platformWebApp.mainMenuService","$state","platformWebApp.toolbarService","platformWebApp.breadcrumbHistoryService",function(e,t,r,o){var a={path:"browse/assets",icon:"fa fa-folder-o",title:"platform.menu.assets",priority:130,action:function(){t.go("workspace.assetsModule")},permission:"platform:asset:access"};e.addMenuItem(a),r.register(o.getBackButtonInstance(),"platformWebApp.assets.assetListController"),r.register(o.getBackButtonInstance(),"platformWebApp.assets.assetSelectController")}])},function(e,t){angular.module("virtoCommerce.assetsModule").controller("virtoCommerce.assetsModule.assetListController",["$scope","$translate","platformWebApp.assets.api","platformWebApp.bladeNavigationService","platformWebApp.dialogService","$sessionStorage","platformWebApp.bladeUtils","platformWebApp.uiGridHelper",function(e,t,r,o,a,n,l,i){var s=e.blade;function c(e,t){return{id:e,name:t,blade:s,navigate:function(e){o.closeBlade(s,(function(){s.disableOpenAnimation=!0,o.showBlade(s,s.parentBlade)}))}}}function u(e){o.closeChildrenBlades(s,(function(){var t={id:"confirmDeleteItem",title:"platform.dialogs.folders-delete.title",message:"platform.dialogs.folders-delete.message",callback:function(t){if(t){var a=_.pluck(e,"url");r.remove({urls:a},s.refresh,(function(e){o.setError("Error "+e.status,s)}))}}};a.showConfirmationDialog(t)}))}s.title="platform.blades.asset-list.title",s.currentEntity||(s.currentEntity={}),s.refresh=function(){s.isLoading=!0,r.search({keyword:s.searchKeyword,folderUrl:s.currentEntity.url},(function(t){e.pageSettings.totalItems=t.totalCount,_.each(t.results,(function(e){e.isImage=e.contentType&&e.contentType.startsWith("image/"),e.isImage&&(e.noCacheUrl=e.url+"?t="+e.modifiedDate)})),e.listEntries=t.results,s.isLoading=!1,function(){if(s.breadcrumbs){var e=s.breadcrumbs.slice(0);if(s.currentEntity.url&&_.all(e,(function(e){return e.id!==s.currentEntity.url}))){var t=c(s.currentEntity.url,s.currentEntity.name);e.push(t)}s.breadcrumbs=e}else s.breadcrumbs=[c(s.currentEntity.url,"platform.blades.asset-list.bread-crumb-top")]}()}))},e.copyUrl=function(e){window.prompt("Copy to clipboard: Ctrl+C, Enter",e.url)},e.downloadUrl=function(e){window.open(e.url,"_blank")},e.delete=function(e){u([e])},e.selectNode=function(e){if("folder"===e.type){var t={id:s.id,breadcrumbs:s.breadcrumbs,currentEntity:e,disableOpenAnimation:!0,controller:s.controller,template:s.template,isClosingDisabled:s.isClosingDisabled};o.showBlade(t,s.parentBlade)}},s.headIcon="fa fa-folder-o",s.toolbarCommands=[{name:"platform.commands.refresh",icon:"fa fa-refresh",title:"platform.commands.titles.refresh",executeMethod:s.refresh,canExecuteMethod:function(){return!0}},{name:"platform.commands.new-folder",icon:"fa fa-folder-o",title:"platform.commands.titles.new-folder",executeMethod:function(){var e,o;e=t.instant("platform.dialogs.create-folder.title"),null!=(o=prompt(e+"\n\nEnter folder name:"))&&r.createFolder({name:o,parentUrl:s.currentEntity.url},s.refresh)},canExecuteMethod:function(){return!0},permission:"platform:asset:create"},{name:"platform.commands.upload",icon:"fa fa-upload",title:"platform.commands.titles.upload",executeMethod:function(){var e={id:"assetUpload",currentEntityId:s.currentEntity.url,title:"platform.blades.asset-upload.title",controller:"virtoCommerce.assetsModule.assetUploadController",template:"Modules/$(VirtoCommerce.Assets)/Scripts/blades/asset-upload.tpl.html"};o.showBlade(e,s)},canExecuteMethod:function(){return!0},permission:"platform:asset:create"},{name:"platform.commands.delete",icon:"fas fa-trash-alt",executeMethod:function(){u(e.gridApi.selection.getSelectedRows())},canExecuteMethod:function(){return e.gridApi&&_.any(e.gridApi.selection.getSelectedRows())},permission:"platform:asset:delete"}],e.setGridOptions=function(t){i.initialize(e,t,(function(t){e.$watch("pageSettings.currentPage",t.pagination.seek)}))},l.initializePagination(e,!0),s.refresh()}])},function(e,t){angular.module("virtoCommerce.assetsModule").controller("virtoCommerce.assetsModule.assetSelectController",["$scope","platformWebApp.assets.api","platformWebApp.bladeNavigationService","platformWebApp.bladeUtils","platformWebApp.uiGridHelper",function(e,t,r,o,a){var n=e.blade;function l(e,t){return{id:e,name:t,blade:n,navigate:function(e){r.closeBlade(n,(function(){n.disableOpenAnimation=!0,r.showBlade(n,n.parentBlade)}))}}}n.template="Modules/$(VirtoCommerce.Assets)/Scripts/blades/asset-select.tpl.html",n.headIcon="fa fa-folder-o",n.currentEntity||(n.currentEntity={}),n.folder&&(n.currentEntity.url="/"+n.folder),n.refresh=function(){n.isLoading=!0,t.search({keyword:n.searchKeyword,folderUrl:n.currentEntity.url},(function(t){e.pageSettings.totalItems=t.totalCount,_.each(t.results,(function(e){e.isImage=e.contentType&&e.contentType.startsWith("image/")})),e.listEntries=t.results,n.isLoading=!1,function(){if(n.breadcrumbs){var e=n.breadcrumbs.slice(0);if(n.currentEntity.url&&_.all(e,(function(e){return e.id!==n.currentEntity.url}))){var t=l(n.currentEntity.url,n.currentEntity.name);e.push(t)}n.breadcrumbs=e}else{var r=n.folder||"platform.blades.asset-list.bread-crumb-top";n.breadcrumbs=[l(n.currentEntity.url,r)]}}()}),(function(e){r.setError("Error "+e.status,n)}))},e.selectNode=function(e){if("folder"===e.type){var t={id:n.id,title:n.title,breadcrumbs:n.breadcrumbs,currentEntity:e,disableOpenAnimation:!0,controller:n.controller,template:n.template,isClosingDisabled:n.isClosingDisabled,onSelect:n.onSelect};r.showBlade(t,n.parentBlade)}},n.toolbarCommands=[{name:"platform.commands.confirm",icon:"fa fa-check",executeMethod:function(){e.saveChanges()},canExecuteMethod:function(){return e.gridApi&&_.any(e.gridApi.selection.getSelectedRows())}}],e.saveChanges=function(){n.onSelect&&n.onSelect(e.gridApi.selection.getSelectedRows()),e.bladeClose()},e.setGridOptions=function(t){a.initialize(e,t,(function(t){e.$watch("pageSettings.currentPage",t.pagination.seek)}))},o.initializePagination(e,!0),n.refresh()}])},function(e,t){angular.module("virtoCommerce.assetsModule").controller("virtoCommerce.assetsModule.assetUploadController",["$scope","platformWebApp.assets.api","platformWebApp.bladeNavigationService","FileUploader","platformWebApp.dialogService",function(e,t,r,o,a){var n,l=e.blade;l.fileUploadOptions||(l.fileUploadOptions={});var i=l.currentEntityId||"";function s(){l.parentBlade.refresh&&!l.fileUploadOptions.suppressParentRefresh&&l.parentBlade.refresh()}function c(e){if(_.any(n,(function(t){return"blob"===t.type&&t.name.toLowerCase()===e.file.name.toLowerCase()}))){var t=prompt('File "'+e.file.name+'" already exists!\n- Change name / press [OK] to overwrite.\n- Press [Cancel] to skip this file.\nFile name:',e.file.name);null==t?e.remove():t?t!==e.file.name?(e.file.name=t,c(e)):e.url+="&forceFileOverwrite=true":c(e)}}e.addImageFromUrl=function(){l.newExternalImageUrl&&(l.uploadCompleted=!1,i?t.uploadFromUrl({folderUrl:i,url:l.newExternalImageUrl},(function(e){s(),l.onUploadComplete&&l.onUploadComplete(e),l.newExternalImageUrl=void 0,l.uploadCompleted=!0})):a.showNotificationDialog({id:"error",title:"platform.dialogs.asset-upload-error.title",message:"platform.dialogs.asset-upload-error.message"}))},l.headIcon="fa fa-file-o",function(){if(!e.uploader){var u=e.uploader=new o({scope:e,url:"api/assets?folderUrl="+i,method:"POST",removeAfterUpload:!0});l.fileUploadOptions.filterCallback&&angular.isFunction(l.fileUploadOptions.filterCallback)?u.filters.push({name:"customFileFilter",fn:l.fileUploadOptions.filterCallback}):l.fileUploadOptions.accept&&l.fileUploadOptions.accept.contains("image")&&u.filters.push({name:"imageFilter",fn:function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|svg+xml|".indexOf(t)}}),u.onAfterAddingAll=function(e){i?(l.isLoading=!0,l.uploadCompleted=!1,r.setError(null,l),t.search({folderUrl:i},(function(t){l.isLoading=!1,n=t.results,_.each(e,c),u.uploadAll()}),(function(e){r.setError("Error "+e.status,l)}))):a.showNotificationDialog({id:"error",title:"platform.dialogs.asset-upload-error.title",message:"platform.dialogs.asset-upload-error.message"})},u.onErrorItem=function(e,t,o,a){r.setError(e._file.name+" failed: "+(t.message?t.message:o),l)},u.onSuccessItem=function(e,t){s(),l.onUploadComplete&&l.onUploadComplete(t),l.uploadCompleted=!0}}}(),l.isLoading=!1}])},function(e,t){angular.module("virtoCommerce.assetsModule").factory("platformWebApp.assets.api",["$resource",function(e){return e("api/assets",{},{search:{method:"GET",url:"api/assets",isArray:!1},createFolder:{method:"POST",url:"api/assets/folder"},move:{method:"POST",url:"api/assets/move"},uploadFromUrl:{method:"POST",params:{url:"@url",folderUrl:"@folderUrl",name:"@name"},isArray:!0}})}])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkFzc2V0cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkFzc2V0cy8uL1NjcmlwdHMvYXNzZXRzLmpzIiwid2VicGFjazovL1ZpcnRvQ29tbWVyY2UuQXNzZXRzLy4vU2NyaXB0cy9ibGFkZXMvYXNzZXQtbGlzdC5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkFzc2V0cy8uL1NjcmlwdHMvYmxhZGVzL2Fzc2V0LXNlbGVjdC5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkFzc2V0cy8uL1NjcmlwdHMvYmxhZGVzL2Fzc2V0LXVwbG9hZC5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkFzc2V0cy8uL1NjcmlwdHMvcmVzb3VyY2VzL2Fzc2V0QXBpLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidW5kZWZpbmVkIiwiQXBwRGVwZW5kZW5jaWVzIiwicHVzaCIsImFuZ3VsYXIiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiYmxhZGVOYXZpZ2F0aW9uU2VydmljZSIsInNob3dCbGFkZSIsImlkIiwidGVtcGxhdGUiLCJpc0Nsb3NpbmdEaXNhYmxlZCIsInJ1biIsIm1haW5NZW51U2VydmljZSIsIiRzdGF0ZSIsInRvb2xiYXJTZXJ2aWNlIiwiYnJlYWRjcnVtYkhpc3RvcnlTZXJ2aWNlIiwibWVudUl0ZW0iLCJwYXRoIiwiaWNvbiIsInRpdGxlIiwicHJpb3JpdHkiLCJhY3Rpb24iLCJnbyIsInBlcm1pc3Npb24iLCJhZGRNZW51SXRlbSIsInJlZ2lzdGVyIiwiZ2V0QmFja0J1dHRvbkluc3RhbmNlIiwiJHRyYW5zbGF0ZSIsImFzc2V0cyIsImRpYWxvZ1NlcnZpY2UiLCIkc3RvcmFnZSIsImJsYWRlVXRpbHMiLCJ1aUdyaWRIZWxwZXIiLCJibGFkZSIsImdlbmVyYXRlQnJlYWRjcnVtYiIsIm5hdmlnYXRlIiwiYnJlYWRjcnVtYiIsImNsb3NlQmxhZGUiLCJkaXNhYmxlT3BlbkFuaW1hdGlvbiIsInBhcmVudEJsYWRlIiwiZGVsZXRlTGlzdCIsInNlbGVjdGlvbiIsImNsb3NlQ2hpbGRyZW5CbGFkZXMiLCJkaWFsb2ciLCJtZXNzYWdlIiwiY2FsbGJhY2siLCJyZW1vdmUiLCJsaXN0RW50cnlJZHMiLCJfIiwicGx1Y2siLCJ1cmxzIiwicmVmcmVzaCIsImVycm9yIiwic2V0RXJyb3IiLCJzdGF0dXMiLCJzaG93Q29uZmlybWF0aW9uRGlhbG9nIiwiY3VycmVudEVudGl0eSIsImlzTG9hZGluZyIsInNlYXJjaCIsImtleXdvcmQiLCJzZWFyY2hLZXl3b3JkIiwiZm9sZGVyVXJsIiwiZGF0YSIsInBhZ2VTZXR0aW5ncyIsInRvdGFsSXRlbXMiLCJ0b3RhbENvdW50IiwiZWFjaCIsInJlc3VsdHMiLCJ4IiwiaXNJbWFnZSIsImNvbnRlbnRUeXBlIiwic3RhcnRzV2l0aCIsIm5vQ2FjaGVVcmwiLCJtb2RpZmllZERhdGUiLCJsaXN0RW50cmllcyIsImJyZWFkY3J1bWJzIiwic2xpY2UiLCJhbGwiLCJicmVhZENydW1iIiwic2V0QnJlYWRjcnVtYnMiLCJjb3B5VXJsIiwid2luZG93IiwicHJvbXB0IiwiZG93bmxvYWRVcmwiLCJvcGVuIiwiZGVsZXRlIiwic2VsZWN0Tm9kZSIsImxpc3RJdGVtIiwidHlwZSIsIm5ld0JsYWRlIiwiaGVhZEljb24iLCJ0b29sYmFyQ29tbWFuZHMiLCJleGVjdXRlTWV0aG9kIiwiY2FuRXhlY3V0ZU1ldGhvZCIsInRvb2x0aXAiLCJyZXN1bHQiLCJpbnN0YW50IiwiY3JlYXRlRm9sZGVyIiwicGFyZW50VXJsIiwiY3VycmVudEVudGl0eUlkIiwiZ3JpZEFwaSIsImdldFNlbGVjdGVkUm93cyIsImFueSIsInNldEdyaWRPcHRpb25zIiwiZ3JpZE9wdGlvbnMiLCJpbml0aWFsaXplIiwiJHdhdGNoIiwicGFnaW5hdGlvbiIsInNlZWsiLCJpbml0aWFsaXplUGFnaW5hdGlvbiIsImFzc2V0c0FwaSIsImZvbGRlciIsIm9uU2VsZWN0Iiwic2F2ZUNoYW5nZXMiLCJibGFkZUNsb3NlIiwiRmlsZVVwbG9hZGVyIiwiY3VycmVudEVudGl0aWVzIiwiZmlsZVVwbG9hZE9wdGlvbnMiLCJyZWZyZXNoUGFyZW50QmxhZGUiLCJzdXBwcmVzc1BhcmVudFJlZnJlc2giLCJwcm9tcHRVc2VyRGVjaXNpb24iLCJpdGVtIiwidG9Mb3dlckNhc2UiLCJmaWxlIiwiYWRkSW1hZ2VGcm9tVXJsIiwibmV3RXh0ZXJuYWxJbWFnZVVybCIsInVwbG9hZENvbXBsZXRlZCIsInVwbG9hZEZyb21VcmwiLCJvblVwbG9hZENvbXBsZXRlIiwic2hvd05vdGlmaWNhdGlvbkRpYWxvZyIsInVwbG9hZGVyIiwic2NvcGUiLCJtZXRob2QiLCJyZW1vdmVBZnRlclVwbG9hZCIsImZpbHRlckNhbGxiYWNrIiwiaXNGdW5jdGlvbiIsImZpbHRlcnMiLCJmbiIsImFjY2VwdCIsImNvbnRhaW5zIiwibGFzdEluZGV4T2YiLCJpbmRleE9mIiwib25BZnRlckFkZGluZ0FsbCIsImFkZGVkSXRlbXMiLCJ1cGxvYWRBbGwiLCJvbkVycm9ySXRlbSIsInJlc3BvbnNlIiwiaGVhZGVycyIsIl9maWxlIiwib25TdWNjZXNzSXRlbSIsImZpbGVJdGVtIiwi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NENBQ1B5QixRQUFTLGlEQUtyQnNGLEVBQVNlLFlBQWMsU0FBVXhCLEVBQU15QixFQUFVNUYsRUFBUTZGLEdBQ3JEN0ksRUFBdUIrQyxTQUFTb0UsRUFBSzJCLE1BQU1sTCxLQUFPLGFBQWVnTCxFQUFTdEcsUUFBVXNHLEVBQVN0RyxRQUFVVSxHQUFTckIsSUFHcEhpRyxFQUFTbUIsY0FBZ0IsU0FBVUMsRUFBVUMsR0FDekNqQyxJQUNJckYsRUFBTStGLGtCQUNOL0YsRUFBTStGLGlCQUFpQnVCLEdBRTNCdEgsRUFBTTZGLGlCQUFrQixJQW1EcENyQixHQUNBeEUsRUFBTXdCLFdBQVksTSxjQzNIMUIzRCxRQUFRcEMsT0FBTyw4QkFDZDhMLFFBQVEsNEJBQTZCLENBQUMsWUFBYSxTQUFVQyxHQUMxRCxPQUFPQSxFQUFVLGFBQWMsR0FBSSxDQUMvQi9GLE9BQVEsQ0FBRTBFLE9BQVEsTUFBT2xJLElBQUssYUFBY3dKLFNBQVMsR0FDckR6RCxhQUFjLENBQUVtQyxPQUFRLE9BQVFsSSxJQUFLLHFCQUNyQ3lKLEtBQU0sQ0FBRXZCLE9BQVEsT0FBUWxJLElBQUssbUJBQzdCNkgsY0FBZSxDQUFFSyxPQUFRLE9BQVF3QixPQUFRLENBQUUxSixJQUFLLE9BQVEyRCxVQUFXLGFBQWMzRixLQUFNLFNBQVd3TCxTQUFTIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIi8vQ2FsbCB0aGlzIHRvIHJlZ2lzdGVyIG91ciBtb2R1bGUgdG8gbWFpbiBhcHBsaWNhdGlvblxudmFyIG1vZHVsZU5hbWUgPSBcInZpcnRvQ29tbWVyY2UuYXNzZXRzTW9kdWxlXCI7XG5cbmlmIChBcHBEZXBlbmRlbmNpZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIEFwcERlcGVuZGVuY2llcy5wdXNoKG1vZHVsZU5hbWUpO1xufVxuXG5cbmFuZ3VsYXIubW9kdWxlKG1vZHVsZU5hbWUsIFtdKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCd3b3Jrc3BhY2UuYXNzZXRzTW9kdWxlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9hc3NldHMnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnJChQbGF0Zm9ybSkvU2NyaXB0cy9jb21tb24vdGVtcGxhdGVzL2hvbWUudHBsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJ3BsYXRmb3JtV2ViQXBwLmJsYWRlTmF2aWdhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCBibGFkZU5hdmlnYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBibGFkZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAnYXNzZXRMaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd2aXJ0b0NvbW1lcmNlLmFzc2V0c01vZHVsZS5hc3NldExpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuQXNzZXRzKS9TY3JpcHRzL2JsYWRlcy9hc3NldC1saXN0LnRwbC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2xvc2luZ0Rpc2FibGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKGJsYWRlKTtcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSk7XG4gICAgfV0pXG5cbiAgICAucnVuKFsncGxhdGZvcm1XZWJBcHAubWFpbk1lbnVTZXJ2aWNlJywgJyRzdGF0ZScsICdwbGF0Zm9ybVdlYkFwcC50b29sYmFyU2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC5icmVhZGNydW1iSGlzdG9yeVNlcnZpY2UnLCBmdW5jdGlvbiAobWFpbk1lbnVTZXJ2aWNlLCAkc3RhdGUsIHRvb2xiYXJTZXJ2aWNlLCBicmVhZGNydW1iSGlzdG9yeVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIG1lbnVJdGVtID0ge1xuICAgICAgICAgICAgcGF0aDogJ2Jyb3dzZS9hc3NldHMnLFxuICAgICAgICAgICAgaWNvbjogJ2ZhIGZhLWZvbGRlci1vJyxcbiAgICAgICAgICAgIHRpdGxlOiAncGxhdGZvcm0ubWVudS5hc3NldHMnLFxuICAgICAgICAgICAgcHJpb3JpdHk6IDEzMCxcbiAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKCkgeyAkc3RhdGUuZ28oJ3dvcmtzcGFjZS5hc3NldHNNb2R1bGUnKTsgfSxcbiAgICAgICAgICAgIHBlcm1pc3Npb246ICdwbGF0Zm9ybTphc3NldDphY2Nlc3MnXG4gICAgICAgIH07XG4gICAgICAgIG1haW5NZW51U2VydmljZS5hZGRNZW51SXRlbShtZW51SXRlbSk7XG5cbiAgICAgICAgLy8gcmVnaXN0ZXIgYmFjay1idXR0b25cbiAgICAgICAgdG9vbGJhclNlcnZpY2UucmVnaXN0ZXIoYnJlYWRjcnVtYkhpc3RvcnlTZXJ2aWNlLmdldEJhY2tCdXR0b25JbnN0YW5jZSgpLCAncGxhdGZvcm1XZWJBcHAuYXNzZXRzLmFzc2V0TGlzdENvbnRyb2xsZXInKTtcbiAgICAgICAgdG9vbGJhclNlcnZpY2UucmVnaXN0ZXIoYnJlYWRjcnVtYkhpc3RvcnlTZXJ2aWNlLmdldEJhY2tCdXR0b25JbnN0YW5jZSgpLCAncGxhdGZvcm1XZWJBcHAuYXNzZXRzLmFzc2V0U2VsZWN0Q29udHJvbGxlcicpO1xuICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLmFzc2V0c01vZHVsZScpXG4gICAgLmNvbnRyb2xsZXIoJ3ZpcnRvQ29tbWVyY2UuYXNzZXRzTW9kdWxlLmFzc2V0TGlzdENvbnRyb2xsZXInLCBbJyRzY29wZScsICckdHJhbnNsYXRlJywgJ3BsYXRmb3JtV2ViQXBwLmFzc2V0cy5hcGknLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC5kaWFsb2dTZXJ2aWNlJywgJyRzZXNzaW9uU3RvcmFnZScsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZVV0aWxzJywgJ3BsYXRmb3JtV2ViQXBwLnVpR3JpZEhlbHBlcicsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICR0cmFuc2xhdGUsIGFzc2V0cywgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSwgZGlhbG9nU2VydmljZSwgJHN0b3JhZ2UsIGJsYWRlVXRpbHMsIHVpR3JpZEhlbHBlcikge1xuICAgICAgICAgICAgdmFyIGJsYWRlID0gJHNjb3BlLmJsYWRlO1xuICAgICAgICAgICAgYmxhZGUudGl0bGUgPSAncGxhdGZvcm0uYmxhZGVzLmFzc2V0LWxpc3QudGl0bGUnO1xuICAgICAgICAgICAgaWYgKCFibGFkZS5jdXJyZW50RW50aXR5KSB7XG4gICAgICAgICAgICAgICAgYmxhZGUuY3VycmVudEVudGl0eSA9IHt9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBibGFkZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYXNzZXRzLnNlYXJjaChcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5d29yZDogYmxhZGUuc2VhcmNoS2V5d29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbGRlclVybDogYmxhZGUuY3VycmVudEVudGl0eS51cmxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlU2V0dGluZ3MudG90YWxJdGVtcyA9IGRhdGEudG90YWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhLnJlc3VsdHMsIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeC5pc0ltYWdlID0geC5jb250ZW50VHlwZSAmJiB4LmNvbnRlbnRUeXBlLnN0YXJ0c1dpdGgoJ2ltYWdlLycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4LmlzSW1hZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeC5ub0NhY2hlVXJsID0geC51cmwgKyAnP3Q9JyArIHgubW9kaWZpZWREYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RFbnRyaWVzID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGUuaXNMb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vU2V0IG5hdmlnYXRpb24gYnJlYWRjcnVtYnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEJyZWFkY3J1bWJzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy9CcmVhZGNydW1ic1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0QnJlYWRjcnVtYnMoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJsYWRlLmJyZWFkY3J1bWJzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQ2xvbmUgYXJyYXkgKGFuZ3VsYXIuY29weSBsZWF2ZXMgdGhlIHNhbWUgcmVmZXJlbmNlKVxuICAgICAgICAgICAgICAgICAgICB2YXIgYnJlYWRjcnVtYnMgPSBibGFkZS5icmVhZGNydW1icy5zbGljZSgwKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3ByZXZlbnQgZHVwbGljYXRlIGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgIGlmIChibGFkZS5jdXJyZW50RW50aXR5LnVybCAmJiBfLmFsbChicmVhZGNydW1icywgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaWQgIT09IGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJyZWFkQ3J1bWIgPSBnZW5lcmF0ZUJyZWFkY3J1bWIoYmxhZGUuY3VycmVudEVudGl0eS51cmwsIGJsYWRlLmN1cnJlbnRFbnRpdHkubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhZGNydW1icy5wdXNoKGJyZWFkQ3J1bWIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmJyZWFkY3J1bWJzID0gYnJlYWRjcnVtYnM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmxhZGUuYnJlYWRjcnVtYnMgPSBbZ2VuZXJhdGVCcmVhZGNydW1iKGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsLCAncGxhdGZvcm0uYmxhZGVzLmFzc2V0LWxpc3QuYnJlYWQtY3J1bWItdG9wJyldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVCcmVhZGNydW1iKGlkLCBuYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICBibGFkZTogYmxhZGUsXG4gICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlOiBmdW5jdGlvbiAoYnJlYWRjcnVtYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5jbG9zZUJsYWRlKGJsYWRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGUuZGlzYWJsZU9wZW5BbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShibGFkZSwgYmxhZGUucGFyZW50QmxhZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBuZXdGb2xkZXIoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvb2x0aXAgPSAkdHJhbnNsYXRlLmluc3RhbnQoJ3BsYXRmb3JtLmRpYWxvZ3MuY3JlYXRlLWZvbGRlci50aXRsZScpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHByb21wdCh0b29sdGlwICsgXCJcXG5cXG5FbnRlciBmb2xkZXIgbmFtZTpcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRzLmNyZWF0ZUZvbGRlcih7IG5hbWU6IHJlc3VsdCwgcGFyZW50VXJsOiBibGFkZS5jdXJyZW50RW50aXR5LnVybCB9LCBibGFkZS5yZWZyZXNoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5jb3B5VXJsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucHJvbXB0KFwiQ29weSB0byBjbGlwYm9hcmQ6IEN0cmwrQywgRW50ZXJcIiwgZGF0YS51cmwpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLmRvd25sb2FkVXJsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbihkYXRhLnVybCwgJ19ibGFuaycpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8kc2NvcGUucmVuYW1lID0gZnVuY3Rpb24gKGxpc3RJdGVtKSB7XG4gICAgICAgICAgICAvLyAgICByZW5hbWUobGlzdEl0ZW0pO1xuICAgICAgICAgICAgLy99O1xuXG4gICAgICAgICAgICAvL2Z1bmN0aW9uIHJlbmFtZShsaXN0SXRlbSkge1xuICAgICAgICAgICAgLy8gICAgdmFyIHJlc3VsdCA9IHByb21wdChcIkVudGVyIG5ldyBuYW1lXCIsIGxpc3RJdGVtLm5hbWUpO1xuICAgICAgICAgICAgLy8gICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgLy8gICAgICAgIGxpc3RJdGVtLm5hbWUgPSByZXN1bHQ7XG4gICAgICAgICAgICAvLyAgICB9XG4gICAgICAgICAgICAvL31cblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNJdGVtc0NoZWNrZWQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5ncmlkQXBpICYmIF8uYW55KCRzY29wZS5ncmlkQXBpLnNlbGVjdGlvbi5nZXRTZWxlY3RlZFJvd3MoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5kZWxldGUgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZUxpc3QoW2RhdGFdKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUxpc3Qoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5jbG9zZUNoaWxkcmVuQmxhZGVzKGJsYWRlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaWFsb2cgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJjb25maXJtRGVsZXRlSXRlbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwicGxhdGZvcm0uZGlhbG9ncy5mb2xkZXJzLWRlbGV0ZS50aXRsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJwbGF0Zm9ybS5kaWFsb2dzLmZvbGRlcnMtZGVsZXRlLm1lc3NhZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAocmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW92ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdEVudHJ5SWRzID0gXy5wbHVjayhzZWxlY3Rpb24sICd1cmwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzLnJlbW92ZSh7IHVybHM6IGxpc3RFbnRyeUlkcyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGUucmVmcmVzaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChlcnJvcikgeyBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKCdFcnJvciAnICsgZXJyb3Iuc3RhdHVzLCBibGFkZSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkaWFsb2dTZXJ2aWNlLnNob3dDb25maXJtYXRpb25EaWFsb2coZGlhbG9nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdE5vZGUgPSBmdW5jdGlvbiAobGlzdEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0JsYWRlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGJsYWRlLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWRjcnVtYnM6IGJsYWRlLmJyZWFkY3J1bWJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEVudGl0eTogbGlzdEl0ZW0sXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlT3BlbkFuaW1hdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGJsYWRlLmNvbnRyb2xsZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYmxhZGUudGVtcGxhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0Nsb3NpbmdEaXNhYmxlZDogYmxhZGUuaXNDbG9zaW5nRGlzYWJsZWRcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUucGFyZW50QmxhZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGJsYWRlLmhlYWRJY29uID0gJ2ZhIGZhLWZvbGRlci1vJztcblxuICAgICAgICAgICAgYmxhZGUudG9vbGJhckNvbW1hbmRzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJwbGF0Zm9ybS5jb21tYW5kcy5yZWZyZXNoXCIsIGljb246ICdmYSBmYS1yZWZyZXNoJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwicGxhdGZvcm0uY29tbWFuZHMudGl0bGVzLnJlZnJlc2hcIixcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZU1ldGhvZDogYmxhZGUucmVmcmVzaCxcbiAgICAgICAgICAgICAgICAgICAgY2FuRXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJwbGF0Zm9ybS5jb21tYW5kcy5uZXctZm9sZGVyXCIsIGljb246ICdmYSBmYS1mb2xkZXItbycsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcInBsYXRmb3JtLmNvbW1hbmRzLnRpdGxlcy5uZXctZm9sZGVyXCIsXG4gICAgICAgICAgICAgICAgICAgIGV4ZWN1dGVNZXRob2Q6IGZ1bmN0aW9uICgpIHsgbmV3Rm9sZGVyKCk7IH0sXG4gICAgICAgICAgICAgICAgICAgIGNhbkV4ZWN1dGVNZXRob2Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uOiAncGxhdGZvcm06YXNzZXQ6Y3JlYXRlJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInBsYXRmb3JtLmNvbW1hbmRzLnVwbG9hZFwiLCBpY29uOiAnZmEgZmEtdXBsb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwicGxhdGZvcm0uY29tbWFuZHMudGl0bGVzLnVwbG9hZFwiLFxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3QmxhZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwiYXNzZXRVcGxvYWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RW50aXR5SWQ6IGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAncGxhdGZvcm0uYmxhZGVzLmFzc2V0LXVwbG9hZC50aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2UuYXNzZXRzTW9kdWxlLmFzc2V0VXBsb2FkQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5Bc3NldHMpL1NjcmlwdHMvYmxhZGVzL2Fzc2V0LXVwbG9hZC50cGwuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjYW5FeGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbjogJ3BsYXRmb3JtOmFzc2V0OmNyZWF0ZSdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8ve1xuICAgICAgICAgICAgICAgIC8vICAgIG5hbWU6IFwiUmVuYW1lXCIsIGljb246ICdmYSBmYS1mb250JyxcbiAgICAgICAgICAgICAgICAvLyAgICBleGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHJlbmFtZShnZXRGaXJzdENoZWNrZWQoKSlcbiAgICAgICAgICAgICAgICAvLyAgICB9LFxuICAgICAgICAgICAgICAgIC8vICAgIGNhbkV4ZWN1dGVNZXRob2Q6IGlzU2luZ2xlQ2hlY2tlZCxcbiAgICAgICAgICAgICAgICAvLyAgICBwZXJtaXNzaW9uOiAncGxhdGZvcm06YXNzZXQ6dXBkYXRlJ1xuICAgICAgICAgICAgICAgIC8vfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwicGxhdGZvcm0uY29tbWFuZHMuZGVsZXRlXCIsIGljb246ICdmYXMgZmEtdHJhc2gtYWx0JyxcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkgeyBkZWxldGVMaXN0KCRzY29wZS5ncmlkQXBpLnNlbGVjdGlvbi5nZXRTZWxlY3RlZFJvd3MoKSk7IH0sXG4gICAgICAgICAgICAgICAgICAgIGNhbkV4ZWN1dGVNZXRob2Q6IGlzSXRlbXNDaGVja2VkLFxuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uOiAncGxhdGZvcm06YXNzZXQ6ZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3tcbiAgICAgICAgICAgICAgICAvLyAgICBuYW1lOiBcIkN1dFwiLFxuICAgICAgICAgICAgICAgIC8vICAgIGljb246ICdmYXMgZmEtY3V0JyxcbiAgICAgICAgICAgICAgICAvLyAgICBleGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgfSxcbiAgICAgICAgICAgICAgICAvLyAgICBjYW5FeGVjdXRlTWV0aG9kOiBpc0l0ZW1zQ2hlY2tlZCxcbiAgICAgICAgICAgICAgICAvLyAgICBwZXJtaXNzaW9uOiAnYXNzZXQ6ZGVsZXRlJ1xuICAgICAgICAgICAgICAgIC8vfSxcbiAgICAgICAgICAgICAgICAvL3tcbiAgICAgICAgICAgICAgICAvLyAgICBuYW1lOiBcIlBhc3RlXCIsXG4gICAgICAgICAgICAgICAgLy8gICAgaWNvbjogJ2ZhcyBmYS1wYXN0ZScsXG4gICAgICAgICAgICAgICAgLy8gICAgZXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICBhc3NldHMubW92ZSh7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBmb2xkZXI6IGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgbGlzdEVudHJpZXM6ICRzdG9yYWdlLmNhdGFsb2dDbGlwYm9hcmRDb250ZW50XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGRlbGV0ZSAkc3RvcmFnZS5jYXRhbG9nQ2xpcGJvYXJkQ29udGVudDtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGJsYWRlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKCdFcnJvciAnICsgZXJyb3Iuc3RhdHVzLCBibGFkZSk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gICAgY2FuRXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICByZXR1cm4gJHN0b3JhZ2UuY2F0YWxvZ0NsaXBib2FyZENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgLy8gICAgfSxcbiAgICAgICAgICAgICAgICAvLyAgICBwZXJtaXNzaW9uOiAnYXNzZXQ6ZGVsZXRlJ1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgLy8gdWktZ3JpZFxuICAgICAgICAgICAgJHNjb3BlLnNldEdyaWRPcHRpb25zID0gZnVuY3Rpb24gKGdyaWRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdWlHcmlkSGVscGVyLmluaXRpYWxpemUoJHNjb3BlLCBncmlkT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGdyaWRBcGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ3BhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZScsIGdyaWRBcGkucGFnaW5hdGlvbi5zZWVrKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYmxhZGVVdGlscy5pbml0aWFsaXplUGFnaW5hdGlvbigkc2NvcGUsIHRydWUpO1xuXG4gICAgICAgICAgICBibGFkZS5yZWZyZXNoKCk7XG4gICAgICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLmFzc2V0c01vZHVsZScpXG4gICAgLmNvbnRyb2xsZXIoJ3ZpcnRvQ29tbWVyY2UuYXNzZXRzTW9kdWxlLmFzc2V0U2VsZWN0Q29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3BsYXRmb3JtV2ViQXBwLmFzc2V0cy5hcGknLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZVV0aWxzJywgJ3BsYXRmb3JtV2ViQXBwLnVpR3JpZEhlbHBlcicsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsIGFzc2V0c0FwaSwgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSwgYmxhZGVVdGlscywgdWlHcmlkSGVscGVyKSB7XG4gICAgICAgICAgICB2YXIgYmxhZGUgPSAkc2NvcGUuYmxhZGU7XG4gICAgICAgICAgICBibGFkZS50ZW1wbGF0ZSA9ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5Bc3NldHMpL1NjcmlwdHMvYmxhZGVzL2Fzc2V0LXNlbGVjdC50cGwuaHRtbCc7XG5cbiAgICAgICAgICAgIGJsYWRlLmhlYWRJY29uID0gJ2ZhIGZhLWZvbGRlci1vJztcblxuICAgICAgICAgICAgaWYgKCFibGFkZS5jdXJyZW50RW50aXR5KSB7XG4gICAgICAgICAgICAgICAgYmxhZGUuY3VycmVudEVudGl0eSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJsYWRlLmZvbGRlcikge1xuICAgICAgICAgICAgICAgIGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsID0gJy8nICsgYmxhZGUuZm9sZGVyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBibGFkZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYXNzZXRzQXBpLnNlYXJjaChcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5d29yZDogYmxhZGUuc2VhcmNoS2V5d29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbGRlclVybDogYmxhZGUuY3VycmVudEVudGl0eS51cmxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlU2V0dGluZ3MudG90YWxJdGVtcyA9IGRhdGEudG90YWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChkYXRhLnJlc3VsdHMsIGZ1bmN0aW9uICh4KSB7IHguaXNJbWFnZSA9IHguY29udGVudFR5cGUgJiYgeC5jb250ZW50VHlwZS5zdGFydHNXaXRoKCdpbWFnZS8nKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdEVudHJpZXMgPSBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXQgbmF2aWdhdGlvbiBicmVhZGNydW1ic1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnJlYWRjcnVtYnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKCdFcnJvciAnICsgZXJyb3Iuc3RhdHVzLCBibGFkZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy9CcmVhZGNydW1ic1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0QnJlYWRjcnVtYnMoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJsYWRlLmJyZWFkY3J1bWJzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQ2xvbmUgYXJyYXkgKGFuZ3VsYXIuY29weSBsZWF2ZXMgdGhlIHNhbWUgcmVmZXJlbmNlKVxuICAgICAgICAgICAgICAgICAgICB2YXIgYnJlYWRjcnVtYnMgPSBibGFkZS5icmVhZGNydW1icy5zbGljZSgwKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3ByZXZlbnQgZHVwbGljYXRlIGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgIGlmIChibGFkZS5jdXJyZW50RW50aXR5LnVybCAmJiBfLmFsbChicmVhZGNydW1icywgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaWQgIT09IGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJyZWFkQ3J1bWIgPSBnZW5lcmF0ZUJyZWFkY3J1bWIoYmxhZGUuY3VycmVudEVudGl0eS51cmwsIGJsYWRlLmN1cnJlbnRFbnRpdHkubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhZGNydW1icy5wdXNoKGJyZWFkQ3J1bWIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmJyZWFkY3J1bWJzID0gYnJlYWRjcnVtYnM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBibGFkZS5mb2xkZXIgfHwgXCJwbGF0Zm9ybS5ibGFkZXMuYXNzZXQtbGlzdC5icmVhZC1jcnVtYi10b3BcIjtcbiAgICAgICAgICAgICAgICAgICAgYmxhZGUuYnJlYWRjcnVtYnMgPSBbZ2VuZXJhdGVCcmVhZGNydW1iKGJsYWRlLmN1cnJlbnRFbnRpdHkudXJsLCBuYW1lKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUJyZWFkY3J1bWIoaWQsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlOiBibGFkZSxcbiAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGU6IGZ1bmN0aW9uIChicmVhZGNydW1iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLmNsb3NlQmxhZGUoYmxhZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5kaXNhYmxlT3BlbkFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKGJsYWRlLCBibGFkZS5wYXJlbnRCbGFkZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzSXRlbXNDaGVja2VkKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZ3JpZEFwaSAmJiBfLmFueSgkc2NvcGUuZ3JpZEFwaS5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRSb3dzKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTZWxlY3RlZEFzc2V0cygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmdyaWRBcGkuc2VsZWN0aW9uLmdldFNlbGVjdGVkUm93cygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0Tm9kZSA9IGZ1bmN0aW9uIChsaXN0SXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0SXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3QmxhZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogYmxhZGUuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYmxhZGUudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhZGNydW1iczogYmxhZGUuYnJlYWRjcnVtYnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RW50aXR5OiBsaXN0SXRlbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVPcGVuQW5pbWF0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogYmxhZGUuY29udHJvbGxlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBibGFkZS50ZW1wbGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2xvc2luZ0Rpc2FibGVkOiBibGFkZS5pc0Nsb3NpbmdEaXNhYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0OiBibGFkZS5vblNlbGVjdFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKG5ld0JsYWRlLCBibGFkZS5wYXJlbnRCbGFkZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYmxhZGUudG9vbGJhckNvbW1hbmRzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3BsYXRmb3JtLmNvbW1hbmRzLmNvbmZpcm0nLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiAnZmEgZmEtY2hlY2snLFxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7ICRzY29wZS5zYXZlQ2hhbmdlcygpOyB9LFxuICAgICAgICAgICAgICAgICAgICBjYW5FeGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNJdGVtc0NoZWNrZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgICRzY29wZS5zYXZlQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoYmxhZGUub25TZWxlY3QpXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLm9uU2VsZWN0KGdldFNlbGVjdGVkQXNzZXRzKCkpO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJsYWRlQ2xvc2UoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIHVpLWdyaWRcbiAgICAgICAgICAgICRzY29wZS5zZXRHcmlkT3B0aW9ucyA9IGZ1bmN0aW9uIChncmlkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHVpR3JpZEhlbHBlci5pbml0aWFsaXplKCRzY29wZSwgZ3JpZE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChncmlkQXBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdwYWdlU2V0dGluZ3MuY3VycmVudFBhZ2UnLCBncmlkQXBpLnBhZ2luYXRpb24uc2Vlayk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGJsYWRlVXRpbHMuaW5pdGlhbGl6ZVBhZ2luYXRpb24oJHNjb3BlLCB0cnVlKTtcblxuICAgICAgICAgICAgYmxhZGUucmVmcmVzaCgpO1xuICAgICAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgndmlydG9Db21tZXJjZS5hc3NldHNNb2R1bGUnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ3ZpcnRvQ29tbWVyY2UuYXNzZXRzTW9kdWxlLmFzc2V0VXBsb2FkQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3BsYXRmb3JtV2ViQXBwLmFzc2V0cy5hcGknLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsICdGaWxlVXBsb2FkZXInLCAncGxhdGZvcm1XZWJBcHAuZGlhbG9nU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsIGFzc2V0cywgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSwgRmlsZVVwbG9hZGVyLCBkaWFsb2dTZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyIGJsYWRlID0gJHNjb3BlLmJsYWRlO1xyXG4gICAgICAgIHZhciBjdXJyZW50RW50aXRpZXM7XHJcbiAgICAgICAgaWYgKCFibGFkZS5maWxlVXBsb2FkT3B0aW9ucykge1xyXG4gICAgICAgICAgICBibGFkZS5maWxlVXBsb2FkT3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZm9sZGVyVXJsID0gYmxhZGUuY3VycmVudEVudGl0eUlkIHx8IFwiXCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLnVwbG9hZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHVwbG9hZGVyXHJcbiAgICAgICAgICAgICAgICB2YXIgdXBsb2FkZXIgPSAkc2NvcGUudXBsb2FkZXIgPSBuZXcgRmlsZVVwbG9hZGVyKHtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJ2FwaS9hc3NldHM/Zm9sZGVyVXJsPScgKyBmb2xkZXJVcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgLy9hdXRvVXBsb2FkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUFmdGVyVXBsb2FkOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYmxhZGUuZmlsZVVwbG9hZE9wdGlvbnMuZmlsdGVyQ2FsbGJhY2sgJiYgYW5ndWxhci5pc0Z1bmN0aW9uKGJsYWRlLmZpbGVVcGxvYWRPcHRpb25zLmZpbHRlckNhbGxiYWNrKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwbG9hZGVyLmZpbHRlcnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjdXN0b21GaWxlRmlsdGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm46IGJsYWRlLmZpbGVVcGxvYWRPcHRpb25zLmZpbHRlckNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJsYWRlLmZpbGVVcGxvYWRPcHRpb25zLmFjY2VwdCAmJiBibGFkZS5maWxlVXBsb2FkT3B0aW9ucy5hY2NlcHQuY29udGFpbnMoJ2ltYWdlJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGxvYWRlci5maWx0ZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW1hZ2VGaWx0ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbjogZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gJ3wnICsgaXRlbS50eXBlLnNsaWNlKGl0ZW0udHlwZS5sYXN0SW5kZXhPZignLycpICsgMSkgKyAnfCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3xqcGd8cG5nfGpwZWd8Ym1wfGdpZnxzdmcreG1sfCcuaW5kZXhPZih0eXBlKSAhPT0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB1cGxvYWRlci5vbkFmdGVyQWRkaW5nQWxsID0gZnVuY3Rpb24gKGFkZGVkSXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9sZGVyVXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYWRlLnVwbG9hZENvbXBsZXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKG51bGwsIGJsYWRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBhc3NldCBkdXBsaWNhdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0cy5zZWFyY2goeyBmb2xkZXJVcmw6IGZvbGRlclVybCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RW50aXRpZXMgPSBkYXRhLnJlc3VsdHM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChhZGRlZEl0ZW1zLCBwcm9tcHRVc2VyRGVjaXNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGVyLnVwbG9hZEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zZXRFcnJvcignRXJyb3IgJyArIGVycm9yLnN0YXR1cywgYmxhZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZ1NlcnZpY2Uuc2hvd05vdGlmaWNhdGlvbkRpYWxvZyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJlcnJvclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwicGxhdGZvcm0uZGlhbG9ncy5hc3NldC11cGxvYWQtZXJyb3IudGl0bGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwicGxhdGZvcm0uZGlhbG9ncy5hc3NldC11cGxvYWQtZXJyb3IubWVzc2FnZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgdXBsb2FkZXIub25FcnJvckl0ZW0gPSBmdW5jdGlvbiAoaXRlbSwgcmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2V0RXJyb3IoaXRlbS5fZmlsZS5uYW1lICsgJyBmYWlsZWQ6ICcgKyAocmVzcG9uc2UubWVzc2FnZSA/IHJlc3BvbnNlLm1lc3NhZ2UgOiBzdGF0dXMpLCBibGFkZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHVwbG9hZGVyLm9uU3VjY2Vzc0l0ZW0gPSBmdW5jdGlvbiAoZmlsZUl0ZW0sIGltYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYXJlbnRCbGFkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChibGFkZS5vblVwbG9hZENvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYWRlLm9uVXBsb2FkQ29tcGxldGUoaW1hZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYmxhZGUudXBsb2FkQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlZnJlc2hQYXJlbnRCbGFkZSgpIHtcclxuICAgICAgICAgICAgaWYgKGJsYWRlLnBhcmVudEJsYWRlLnJlZnJlc2ggJiYgIWJsYWRlLmZpbGVVcGxvYWRPcHRpb25zLnN1cHByZXNzUGFyZW50UmVmcmVzaCkge1xyXG4gICAgICAgICAgICAgICAgYmxhZGUucGFyZW50QmxhZGUucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBwcm9tcHRVc2VyRGVjaXNpb24oaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoXy5hbnkoY3VycmVudEVudGl0aWVzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50eXBlID09PSAnYmxvYicgJiYgeC5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IGl0ZW0uZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCkgfSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwcm9tcHQoXCJGaWxlIFxcXCJcIiArIGl0ZW0uZmlsZS5uYW1lICsgXCJcXFwiIGFscmVhZHkgZXhpc3RzIVxcbi0gQ2hhbmdlIG5hbWUgLyBwcmVzcyBbT0tdIHRvIG92ZXJ3cml0ZS5cXG4tIFByZXNzIFtDYW5jZWxdIHRvIHNraXAgdGhpcyBmaWxlLlxcbkZpbGUgbmFtZTpcIiwgaXRlbS5maWxlLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb21wdFVzZXJEZWNpc2lvbihpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0ICE9PSBpdGVtLmZpbGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uZmlsZS5uYW1lID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHByb21wdFVzZXJEZWNpc2lvbihpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS51cmwgKz0gXCImZm9yY2VGaWxlT3ZlcndyaXRlPXRydWVcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLmFkZEltYWdlRnJvbVVybCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGJsYWRlLm5ld0V4dGVybmFsSW1hZ2VVcmwpIHtcclxuICAgICAgICAgICAgICAgIGJsYWRlLnVwbG9hZENvbXBsZXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZvbGRlclVybCkgeyAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRzLnVwbG9hZEZyb21VcmwoeyBmb2xkZXJVcmw6IGZvbGRlclVybCwgdXJsOiBibGFkZS5uZXdFeHRlcm5hbEltYWdlVXJsIH0sIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYXJlbnRCbGFkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmxhZGUub25VcGxvYWRDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhZGUub25VcGxvYWRDb21wbGV0ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5uZXdFeHRlcm5hbEltYWdlVXJsID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZS51cGxvYWRDb21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkaWFsb2dTZXJ2aWNlLnNob3dOb3RpZmljYXRpb25EaWFsb2coe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJlcnJvclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJwbGF0Zm9ybS5kaWFsb2dzLmFzc2V0LXVwbG9hZC1lcnJvci50aXRsZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcInBsYXRmb3JtLmRpYWxvZ3MuYXNzZXQtdXBsb2FkLWVycm9yLm1lc3NhZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYmxhZGUuaGVhZEljb24gPSAnZmEgZmEtZmlsZS1vJztcclxuXHJcbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgfV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgndmlydG9Db21tZXJjZS5hc3NldHNNb2R1bGUnKVxuLmZhY3RvcnkoJ3BsYXRmb3JtV2ViQXBwLmFzc2V0cy5hcGknLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uICgkcmVzb3VyY2UpIHtcbiAgICByZXR1cm4gJHJlc291cmNlKCdhcGkvYXNzZXRzJywge30sIHtcbiAgICAgICAgc2VhcmNoOiB7IG1ldGhvZDogJ0dFVCcsIHVybDogJ2FwaS9hc3NldHMnLCBpc0FycmF5OiBmYWxzZSB9LFxuICAgICAgICBjcmVhdGVGb2xkZXI6IHsgbWV0aG9kOiAnUE9TVCcsIHVybDogJ2FwaS9hc3NldHMvZm9sZGVyJyB9LFxuICAgICAgICBtb3ZlOiB7IG1ldGhvZDogJ1BPU1QnLCB1cmw6ICdhcGkvYXNzZXRzL21vdmUnIH0sXG4gICAgICAgIHVwbG9hZEZyb21Vcmw6IHsgbWV0aG9kOiAnUE9TVCcsIHBhcmFtczogeyB1cmw6ICdAdXJsJywgZm9sZGVyVXJsOiAnQGZvbGRlclVybCcsIG5hbWU6ICdAbmFtZScgfSwgaXNBcnJheTogdHJ1ZSB9XG4gICAgfSk7XG59XSk7XG5cbiJdLCJzb3VyY2VSb290IjoiIn0=