!function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){i(1),i(2),i(3),i(4),e.exports=i(5)},function(e,t){null!=AppDependencies&&AppDependencies.push("virtoCommerce.shippingModule"),angular.module("virtoCommerce.shippingModule",["ngSanitize"]).run(["platformWebApp.widgetService",function(e){e.registerWidget({controller:"virtoCommerce.shippingModule.storeShippingWidgetController",template:"Modules/$(VirtoCommerce.Shipping)/Scripts/widgets/storeShippingWidget.tpl.html"},"storeDetail"),e.registerWidget({controller:"platformWebApp.entitySettingsWidgetController",template:"$(Platform)/Scripts/app/settings/widgets/entitySettingsWidget.tpl.html"},"shippingMethodDetail")}])},function(e,t){angular.module("virtoCommerce.shippingModule").controller("virtoCommerce.shippingModule.shippingMethodDetailController",["$scope","platformWebApp.bladeNavigationService","virtoCommerce.shippingModule.shippingMethods","platformWebApp.settings",function(e,t,i,o){var n=e.blade;function r(e){n.title="shipping.labels."+e.typeName+".name",n.currentEntity=angular.copy(e),n.origEntity=e,n.isLoading=!1}function s(){return!angular.equals(n.currentEntity,n.origEntity)&&n.hasUpdatePermission()}function p(){return s()}n.refresh=function(e){n.isLoading=!0,n.shippingMethod.id?i.get({id:n.shippingMethod.id},(function(t){r(t),e&&n.parentBlade.refresh()}),(function(e){t.setError("Error "+e.status,n)})):r(n.shippingMethod)},n.onClose=function(i){t.showConfirmationIfNeeded(s(),p(),n,e.saveChanges,i,"shipping.dialogs.shipping-method-save.title","shipping.dialogs.shipping-method-save.message")},e.cancelChanges=function(){e.bladeClose()},e.saveChanges=function(){n.isLoading=!0,n.currentEntity.storeId=n.storeId,i.update({},n.currentEntity,(function(e){n.shippingMethod.id=e.id,n.refresh(!0)}),(function(e){t.setError("Error "+e.status,n)}))},e.setForm=function(t){e.formScope=t},e.getDictionaryValues=function(e,t){t(e.allowedValues)},n.openDictionarySettingManagement=function(e){var i={id:"settingDetailChild",isApiSave:!0,controller:"platformWebApp.settingDictionaryController",template:"$(Platform)/Scripts/app/settings/blades/setting-dictionary.tpl.html"};switch(e){case"TaxTypes":_.extend(i,{currentEntityId:"VirtoCommerce.Core.General.TaxTypes",parentRefresh:function(e){n.taxTypes=e}})}t.showBlade(i,n)},n.headIcon="fa fa-archive",n.toolbarCommands=[{name:"platform.commands.save",icon:"fa fa-save",executeMethod:e.saveChanges,canExecuteMethod:p,permission:n.updatePermission},{name:"platform.commands.reset",icon:"fa fa-undo",executeMethod:function(){angular.copy(n.origEntity,n.currentEntity)},canExecuteMethod:s,permission:n.updatePermission}],n.taxTypes=o.getValues({id:"VirtoCommerce.Core.General.TaxTypes"}),n.refresh()}])},function(e,t){angular.module("virtoCommerce.shippingModule").controller("virtoCommerce.shippingModule.shippingMethodListController",["$scope","platformWebApp.bladeNavigationService","virtoCommerce.shippingModule.shippingMethods",function(e,t,i){var o=e.blade;o.refresh=function(){o.isLoading=!0,i.search({storeId:o.storeId},(function(e){o.isLoading=!1,o.currentEntities=e.results,o.selectedShippingMethods=_.findWhere(o.currentEntities,{isActive:!0})}),(function(e){t.setError("Error "+e.status,o)}))},e.selectNode=function(i){e.selectedNodeId=i.typeName;var n={id:"shippingMethodDetail",shippingMethod:i,storeId:o.storeId,subtitle:"shipping.blades.shipping-method-detail.subtitle",controller:"virtoCommerce.shippingModule.shippingMethodDetailController",template:"Modules/$(VirtoCommerce.Shipping)/Scripts/blades/shippingMethod-detail.tpl.html"};t.showBlade(n,e.blade)},o.isLoading=!1,o.headIcon="fa fa-archive",e.sortableOptions={stop:function(t,i){for(var o=0;o<e.blade.currentEntities.length;o++)e.blade.currentEntities[o].priority=o+1},axis:"y",cursor:"move"},o.toolbarCommands=[{name:"platform.commands.refresh",icon:"fa fa-refresh",executeMethod:o.refresh,canExecuteMethod:function(){return!0}}],o.refresh()}])},function(e,t){angular.module("virtoCommerce.shippingModule").factory("virtoCommerce.shippingModule.shippingMethods",["$resource",function(e){return e("api/shipping",{},{getAllRegistered:{method:"GET",isArray:!0},search:{method:"POST",url:"api/shipping/search"},get:{url:"api/shipping/:id"},update:{method:"PUT"}})}])},function(e,t){angular.module("virtoCommerce.shippingModule").controller("virtoCommerce.shippingModule.storeShippingWidgetController",["$scope","platformWebApp.bladeNavigationService",function(e,t){var i=e.blade;e.openBlade=function(){var e={id:"storeChildBlade",storeId:i.currentEntity.id,title:i.title,subtitle:"shipping.widgets.store-shipping-widget.blade-subtitle",controller:"virtoCommerce.shippingModule.shippingMethodListController",template:"Modules/$(VirtoCommerce.Shipping)/Scripts/blades/shippingMethod-list.tpl.html"};t.showBlade(e,i)}}])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLlNoaXBwaW5nL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1ZpcnRvQ29tbWVyY2UuU2hpcHBpbmcvLi9TY3JpcHRzL3NoaXBwaW5nLmpzIiwid2VicGFjazovL1ZpcnRvQ29tbWVyY2UuU2hpcHBpbmcvLi9TY3JpcHRzL2JsYWRlcy9zaGlwcGluZ01ldGhvZC1kZXRhaWwuanMiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5TaGlwcGluZy8uL1NjcmlwdHMvYmxhZGVzL3NoaXBwaW5nTWV0aG9kLWxpc3QuanMiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5TaGlwcGluZy8uL1NjcmlwdHMvcmVzb3VyY2VzL3NoaXBwaW5nTWV0aG9kcy5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLlNoaXBwaW5nLy4vU2NyaXB0cy93aWRnZXRzL3N0b3JlU2hpcHBpbmdXaWRnZXQuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJ1bmRlZmluZWQiLCJBcHBEZXBlbmRlbmNpZXMiLCJwdXNoIiwiYW5ndWxhciIsInJ1biIsIndpZGdldFNlcnZpY2UiLCJyZWdpc3RlcldpZGdldCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZSIsIiRzY29wZSIsImJsYWRlTmF2aWdhdGlvblNlcnZpY2UiLCJzaGlwcGluZ01ldGhvZHMiLCJzZXR0aW5ncyIsImJsYWRlIiwiaW5pdGlhbGl6ZUJsYWRlIiwiZGF0YSIsInRpdGxlIiwidHlwZU5hbWUiLCJjdXJyZW50RW50aXR5IiwiY29weSIsIm9yaWdFbnRpdHkiLCJpc0xvYWRpbmciLCJpc0RpcnR5IiwiZXF1YWxzIiwiaGFzVXBkYXRlUGVybWlzc2lvbiIsImNhblNhdmUiLCJyZWZyZXNoIiwicGFyZW50UmVmcmVzaCIsInNoaXBwaW5nTWV0aG9kIiwiaWQiLCJwYXJlbnRCbGFkZSIsImVycm9yIiwic2V0RXJyb3IiLCJzdGF0dXMiLCJvbkNsb3NlIiwiY2xvc2VDYWxsYmFjayIsInNob3dDb25maXJtYXRpb25JZk5lZWRlZCIsInNhdmVDaGFuZ2VzIiwiY2FuY2VsQ2hhbmdlcyIsImJsYWRlQ2xvc2UiLCJzdG9yZUlkIiwidXBkYXRlIiwic2V0Rm9ybSIsImZvcm0iLCJmb3JtU2NvcGUiLCJnZXREaWN0aW9uYXJ5VmFsdWVzIiwic2V0dGluZyIsImNhbGxiYWNrIiwiYWxsb3dlZFZhbHVlcyIsIm9wZW5EaWN0aW9uYXJ5U2V0dGluZ01hbmFnZW1lbnQiLCJuZXdCbGFkZSIsImlzQXBpU2F2ZSIsIl8iLCJleHRlbmQiLCJjdXJyZW50RW50aXR5SWQiLCJ0YXhUeXBlcyIsInNob3dCbGFkZSIsImhlYWRJY29uIiwidG9vbGJhckNvbW1hbmRzIiwiaWNvbiIsImV4ZWN1dGVNZXRob2QiLCJjYW5FeGVjdXRlTWV0aG9kIiwicGVybWlzc2lvbiIsInVwZGF0ZVBlcm1pc3Npb24iLCJnZXRWYWx1ZXMiLCJzZWFyY2giLCJjdXJyZW50RW50aXRpZXMiLCJyZXN1bHRzIiwic2VsZWN0ZWRTaGlwcGluZ01ldGhvZHMiLCJmaW5kV2hlcmUiLCJpc0FjdGl2ZSIsInNlbGVjdE5vZGUiLCJub2RlIiwic2VsZWN0ZWROb2RlSWQiLCJzdWJ0aXRsZSIsInNvcnRhYmxlT3B0aW9ucyIsInN0b3AiLCJlIiwidWkiLCJsZW5ndGgiLCJwcmlvcml0eSIsImF4aXMiLCJjdXJzb3IiLCJmYWN0b3J5IiwiJHJlc291cmNlIiwiZ2V0QWxsUmVnaXN0ZXJlZCIsIm1ldGhvZCIsImlzQXJyYXkiLCJ1cmwiLCJvcGVuQmxhZGUiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsb0VDL0U5QkMsTUFBbkJDLGlCQUNBQSxnQkFBZ0JDLEtBSEgsZ0NBTWpCQyxRQUFRcEMsT0FOUywrQkFNVSxDQUFDLGVBQ3ZCcUMsSUFBSSxDQUFDLCtCQUFnQyxTQUFVQyxHQUU1Q0EsRUFBY0MsZUFBZSxDQUN6QkMsV0FBWSw2REFDWkMsU0FBVSxrRkFDWCxlQUVISCxFQUFjQyxlQUFlLENBQ3pCQyxXQUFZLGdEQUNaQyxTQUFVLDBFQUNYLDRCLGNDbEJYTCxRQUFRcEMsT0FBTyxnQ0FDVndDLFdBQVcsOERBQStELENBQUMsU0FBVSx3Q0FBeUMsK0NBQWdELDBCQUMzSyxTQUFVRSxFQUFRQyxFQUF3QkMsRUFBaUJDLEdBQ3ZELElBQUlDLEVBQVFKLEVBQU9JLE1BRW5CLFNBQVNDLEVBQWdCQyxHQUNyQkYsRUFBTUcsTUFBUSxtQkFBcUJELEVBQUtFLFNBQVcsUUFDbkRKLEVBQU1LLGNBQWdCZixRQUFRZ0IsS0FBS0osR0FDbkNGLEVBQU1PLFdBQWFMLEVBQ25CRixFQUFNUSxXQUFZLEVBbUJ0QixTQUFTQyxJQUNMLE9BQVFuQixRQUFRb0IsT0FBT1YsRUFBTUssY0FBZUwsRUFBTU8sYUFBZVAsRUFBTVcsc0JBRzNFLFNBQVNDLElBQ0wsT0FBT0gsSUFyQlhULEVBQU1hLFFBQVUsU0FBVUMsR0FDdEJkLEVBQU1RLFdBQVksRUFDZFIsRUFBTWUsZUFBZUMsR0FDckJsQixFQUFnQjlCLElBQUksQ0FBRWdELEdBQUloQixFQUFNZSxlQUFlQyxLQUFNLFNBQVVkLEdBQzNERCxFQUFnQkMsR0FDWlksR0FDQWQsRUFBTWlCLFlBQVlKLGFBR3RCLFNBQVVLLEdBQVNyQixFQUF1QnNCLFNBQVMsU0FBV0QsRUFBTUUsT0FBUXBCLE1BR2hGQyxFQUFnQkQsRUFBTWUsaUJBWTlCZixFQUFNcUIsUUFBVSxTQUFVQyxHQUN0QnpCLEVBQXVCMEIseUJBQXlCZCxJQUFXRyxJQUFXWixFQUFPSixFQUFPNEIsWUFBYUYsRUFBZSw4Q0FBK0Msa0RBR25LMUIsRUFBTzZCLGNBQWdCLFdBQ25CN0IsRUFBTzhCLGNBR1g5QixFQUFPNEIsWUFBYyxXQUNqQnhCLEVBQU1RLFdBQVksRUFDbEJSLEVBQU1LLGNBQWNzQixRQUFVM0IsRUFBTTJCLFFBQ3BDN0IsRUFBZ0I4QixPQUFPLEdBQUk1QixFQUFNSyxlQUFlLFNBQVVILEdBQ3RERixFQUFNZSxlQUFlQyxHQUFLZCxFQUFLYyxHQUMvQmhCLEVBQU1hLFNBQVEsTUFDZixTQUFVSyxHQUFTckIsRUFBdUJzQixTQUFTLFNBQVdELEVBQU1FLE9BQVFwQixPQUduRkosRUFBT2lDLFFBQVUsU0FBVUMsR0FDdkJsQyxFQUFPbUMsVUFBWUQsR0FHdkJsQyxFQUFPb0Msb0JBQXNCLFNBQVVDLEVBQVNDLEdBQzVDQSxFQUFTRCxFQUFRRSxnQkFHckJuQyxFQUFNb0MsZ0NBQWtDLFNBQVVILEdBQzlDLElBQUlJLEVBQVcsQ0FDWHJCLEdBQUkscUJBQ0pzQixXQUFXLEVBQ1g1QyxXQUFZLDZDQUNaQyxTQUFVLHVFQUVkLE9BQVFzQyxHQUNKLElBQUssV0FDRE0sRUFBRUMsT0FBT0gsRUFBVSxDQUNmSSxnQkFBaUIsc0NBQ2pCM0IsY0FBZSxTQUFVWixHQUFRRixFQUFNMEMsU0FBV3hDLEtBSzlETCxFQUF1QjhDLFVBQVVOLEVBQVVyQyxJQUcvQ0EsRUFBTTRDLFNBQVcsZ0JBRWpCNUMsRUFBTTZDLGdCQUFrQixDQUNwQixDQUNJbkYsS0FBTSx5QkFDTm9GLEtBQU0sYUFDTkMsY0FBZW5ELEVBQU80QixZQUN0QndCLGlCQUFrQnBDLEVBQ2xCcUMsV0FBWWpELEVBQU1rRCxrQkFFdEIsQ0FDSXhGLEtBQU0sMEJBQ05vRixLQUFNLGFBQ05DLGNBQWUsV0FDWHpELFFBQVFnQixLQUFLTixFQUFNTyxXQUFZUCxFQUFNSyxnQkFFekMyQyxpQkFBa0J2QyxFQUNsQndDLFdBQVlqRCxFQUFNa0QsbUJBSTFCbEQsRUFBTTBDLFNBQVczQyxFQUFTb0QsVUFBVSxDQUFFbkMsR0FBSSx3Q0FFMUNoQixFQUFNYSxjLGNDdkdsQnZCLFFBQVFwQyxPQUFPLGdDQUFnQ3dDLFdBQVcsNERBQTZELENBQUMsU0FBVSx3Q0FBeUMsK0NBQWdELFNBQVVFLEVBQVFDLEVBQXdCQyxHQUNqUSxJQUFJRSxFQUFRSixFQUFPSSxNQTJCbkJBLEVBQU1hLFFBQVUsV0FDWmIsRUFBTVEsV0FBWSxFQUNsQlYsRUFBZ0JzRCxPQUFPLENBQ25CekIsUUFBUzNCLEVBQU0yQixVQUNoQixTQUFVekIsR0FDVEYsRUFBTVEsV0FBWSxFQUNsQlIsRUFBTXFELGdCQUFrQm5ELEVBQUtvRCxRQUM3QnRELEVBQU11RCx3QkFBMEJoQixFQUFFaUIsVUFBVXhELEVBQU1xRCxnQkFBaUIsQ0FBRUksVUFBVSxPQUNoRixTQUFVdkMsR0FDVHJCLEVBQXVCc0IsU0FBUyxTQUFXRCxFQUFNRSxPQUFRcEIsT0FJakVKLEVBQU84RCxXQUFhLFNBQVVDLEdBQzFCL0QsRUFBT2dFLGVBQWlCRCxFQUFLdkQsU0FDN0IsSUFBSWlDLEVBQVcsQ0FDWHJCLEdBQUksdUJBQ0pELGVBQWdCNEMsRUFDaEJoQyxRQUFTM0IsRUFBTTJCLFFBQ2ZrQyxTQUFVLGtEQUNWbkUsV0FBWSw4REFDWkMsU0FBVSxtRkFFZEUsRUFBdUI4QyxVQUFVTixFQUFVekMsRUFBT0ksUUEvQ2xEQSxFQUFNUSxXQUFZLEVBQ2xCUixFQUFNNEMsU0FBVyxnQkFFakJoRCxFQUFPa0UsZ0JBQWtCLENBQ3JCQyxLQUFNLFNBQVVDLEVBQUdDLEdBQ2YsSUFBSyxJQUFJOUcsRUFBSSxFQUFHQSxFQUFJeUMsRUFBT0ksTUFBTXFELGdCQUFnQmEsT0FBUS9HLElBQ3JEeUMsRUFBT0ksTUFBTXFELGdCQUFnQmxHLEdBQUdnSCxTQUFXaEgsRUFBSSxHQUd2RGlILEtBQU0sSUFDTkMsT0FBUSxRQUdackUsRUFBTTZDLGdCQUFrQixDQUNwQixDQUNJbkYsS0FBTSw0QkFBNkJvRixLQUFNLGdCQUN6Q0MsY0FBZS9DLEVBQU1hLFFBQ3JCbUMsaUJBQWtCLFdBQWMsT0FBTyxLQUkvQ2hELEVBQU1hLGMsY0N6QmR2QixRQUFRcEMsT0FBTyxnQ0FDVm9ILFFBQVEsK0NBQWdELENBQUMsWUFBYSxTQUFVQyxHQUM3RSxPQUFPQSxFQUFVLGVBQWdCLEdBQUksQ0FDakNDLGlCQUFrQixDQUFFQyxPQUFRLE1BQU9DLFNBQVMsR0FDNUN0QixPQUFRLENBQUVxQixPQUFRLE9BQVFFLElBQUssdUJBQy9CM0csSUFBSyxDQUFFMkcsSUFBSyxvQkFDWi9DLE9BQVEsQ0FBRTZDLE9BQVEsYSxjQ045Qm5GLFFBQVFwQyxPQUFPLGdDQUFnQ3dDLFdBQVcsNkRBQThELENBQUMsU0FBVSx3Q0FBeUMsU0FBVUUsRUFBUUMsR0FDMUwsSUFBSUcsRUFBUUosRUFBT0ksTUFFbkJKLEVBQU9nRixVQUFZLFdBQ2YsSUFBSXZDLEVBQVcsQ0FDWHJCLEdBQUksa0JBQ0pXLFFBQVMzQixFQUFNSyxjQUFjVyxHQUM3QmIsTUFBT0gsRUFBTUcsTUFDYjBELFNBQVUsd0RBQ1ZuRSxXQUFZLDREQUNaQyxTQUFVLGlGQUVkRSxFQUF1QjhDLFVBQVVOLEVBQVVyQyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvL0NhbGwgdGhpcyB0byByZWdpc3RlciBvdXIgbW9kdWxlIHRvIG1haW4gYXBwbGljYXRpb25cbnZhciBtb2R1bGVOYW1lID0gXCJ2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlXCI7XG5cbmlmIChBcHBEZXBlbmRlbmNpZXMgIT0gdW5kZWZpbmVkKSB7XG4gICAgQXBwRGVwZW5kZW5jaWVzLnB1c2gobW9kdWxlTmFtZSk7XG59XG5cbmFuZ3VsYXIubW9kdWxlKG1vZHVsZU5hbWUsIFsnbmdTYW5pdGl6ZSddKVxuICAgIC5ydW4oWydwbGF0Zm9ybVdlYkFwcC53aWRnZXRTZXJ2aWNlJywgZnVuY3Rpb24gKHdpZGdldFNlcnZpY2UpIHtcblxuICAgICAgICB3aWRnZXRTZXJ2aWNlLnJlZ2lzdGVyV2lkZ2V0KHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlLnN0b3JlU2hpcHBpbmdXaWRnZXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuU2hpcHBpbmcpL1NjcmlwdHMvd2lkZ2V0cy9zdG9yZVNoaXBwaW5nV2lkZ2V0LnRwbC5odG1sJ1xuICAgICAgICB9LCAnc3RvcmVEZXRhaWwnKTtcblxuICAgICAgICB3aWRnZXRTZXJ2aWNlLnJlZ2lzdGVyV2lkZ2V0KHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwbGF0Zm9ybVdlYkFwcC5lbnRpdHlTZXR0aW5nc1dpZGdldENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICckKFBsYXRmb3JtKS9TY3JpcHRzL2FwcC9zZXR0aW5ncy93aWRnZXRzL2VudGl0eVNldHRpbmdzV2lkZ2V0LnRwbC5odG1sJ1xuICAgICAgICB9LCAnc2hpcHBpbmdNZXRob2REZXRhaWwnKTtcblxuICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlJylcbiAgICAuY29udHJvbGxlcigndmlydG9Db21tZXJjZS5zaGlwcGluZ01vZHVsZS5zaGlwcGluZ01ldGhvZERldGFpbENvbnRyb2xsZXInLCBbJyRzY29wZScsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZU5hdmlnYXRpb25TZXJ2aWNlJywgJ3ZpcnRvQ29tbWVyY2Uuc2hpcHBpbmdNb2R1bGUuc2hpcHBpbmdNZXRob2RzJywgJ3BsYXRmb3JtV2ViQXBwLnNldHRpbmdzJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSwgc2hpcHBpbmdNZXRob2RzLCBzZXR0aW5ncykge1xuICAgICAgICAgICAgdmFyIGJsYWRlID0gJHNjb3BlLmJsYWRlO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplQmxhZGUoZGF0YSkge1xuICAgICAgICAgICAgICAgIGJsYWRlLnRpdGxlID0gJ3NoaXBwaW5nLmxhYmVscy4nICsgZGF0YS50eXBlTmFtZSArICcubmFtZSc7XG4gICAgICAgICAgICAgICAgYmxhZGUuY3VycmVudEVudGl0eSA9IGFuZ3VsYXIuY29weShkYXRhKTtcbiAgICAgICAgICAgICAgICBibGFkZS5vcmlnRW50aXR5ID0gZGF0YTtcbiAgICAgICAgICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYmxhZGUucmVmcmVzaCA9IGZ1bmN0aW9uIChwYXJlbnRSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgYmxhZGUuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoYmxhZGUuc2hpcHBpbmdNZXRob2QuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcHBpbmdNZXRob2RzLmdldCh7IGlkOiBibGFkZS5zaGlwcGluZ01ldGhvZC5pZCB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6ZUJsYWRlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFJlZnJlc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5wYXJlbnRCbGFkZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyb3IpIHsgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zZXRFcnJvcignRXJyb3IgJyArIGVycm9yLnN0YXR1cywgYmxhZGUpOyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVCbGFkZShibGFkZS5zaGlwcGluZ01ldGhvZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBpc0RpcnR5KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhYW5ndWxhci5lcXVhbHMoYmxhZGUuY3VycmVudEVudGl0eSwgYmxhZGUub3JpZ0VudGl0eSkgJiYgYmxhZGUuaGFzVXBkYXRlUGVybWlzc2lvbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYW5TYXZlKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpc0RpcnR5KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJsYWRlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoY2xvc2VDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0NvbmZpcm1hdGlvbklmTmVlZGVkKGlzRGlydHkoKSwgY2FuU2F2ZSgpLCBibGFkZSwgJHNjb3BlLnNhdmVDaGFuZ2VzLCBjbG9zZUNhbGxiYWNrLCBcInNoaXBwaW5nLmRpYWxvZ3Muc2hpcHBpbmctbWV0aG9kLXNhdmUudGl0bGVcIiwgXCJzaGlwcGluZy5kaWFsb2dzLnNoaXBwaW5nLW1ldGhvZC1zYXZlLm1lc3NhZ2VcIik7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuY2FuY2VsQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYmxhZGVDbG9zZSgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLnNhdmVDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYmxhZGUuY3VycmVudEVudGl0eS5zdG9yZUlkID0gYmxhZGUuc3RvcmVJZDtcbiAgICAgICAgICAgICAgICBzaGlwcGluZ01ldGhvZHMudXBkYXRlKHt9LCBibGFkZS5jdXJyZW50RW50aXR5LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBibGFkZS5zaGlwcGluZ01ldGhvZC5pZCA9IGRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLnJlZnJlc2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7IGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2V0RXJyb3IoJ0Vycm9yICcgKyBlcnJvci5zdGF0dXMsIGJsYWRlKTsgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuc2V0Rm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1TY29wZSA9IGZvcm07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXREaWN0aW9uYXJ5VmFsdWVzID0gZnVuY3Rpb24gKHNldHRpbmcsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soc2V0dGluZy5hbGxvd2VkVmFsdWVzKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGJsYWRlLm9wZW5EaWN0aW9uYXJ5U2V0dGluZ01hbmFnZW1lbnQgPSBmdW5jdGlvbiAoc2V0dGluZykge1xuICAgICAgICAgICAgICAgIHZhciBuZXdCbGFkZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdzZXR0aW5nRGV0YWlsQ2hpbGQnLFxuICAgICAgICAgICAgICAgICAgICBpc0FwaVNhdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwbGF0Zm9ybVdlYkFwcC5zZXR0aW5nRGljdGlvbmFyeUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJyQoUGxhdGZvcm0pL1NjcmlwdHMvYXBwL3NldHRpbmdzL2JsYWRlcy9zZXR0aW5nLWRpY3Rpb25hcnkudHBsLmh0bWwnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHNldHRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnVGF4VHlwZXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgXy5leHRlbmQobmV3QmxhZGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RW50aXR5SWQ6ICdWaXJ0b0NvbW1lcmNlLkNvcmUuR2VuZXJhbC5UYXhUeXBlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50UmVmcmVzaDogZnVuY3Rpb24gKGRhdGEpIHsgYmxhZGUudGF4VHlwZXMgPSBkYXRhOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKG5ld0JsYWRlLCBibGFkZSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBibGFkZS5oZWFkSWNvbiA9ICdmYSBmYS1hcmNoaXZlJztcblxuICAgICAgICAgICAgYmxhZGUudG9vbGJhckNvbW1hbmRzID0gWyAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwicGxhdGZvcm0uY29tbWFuZHMuc2F2ZVwiLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiAnZmEgZmEtc2F2ZScsXG4gICAgICAgICAgICAgICAgICAgIGV4ZWN1dGVNZXRob2Q6ICRzY29wZS5zYXZlQ2hhbmdlcyxcbiAgICAgICAgICAgICAgICAgICAgY2FuRXhlY3V0ZU1ldGhvZDogY2FuU2F2ZSxcbiAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbjogYmxhZGUudXBkYXRlUGVybWlzc2lvblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInBsYXRmb3JtLmNvbW1hbmRzLnJlc2V0XCIsXG4gICAgICAgICAgICAgICAgICAgIGljb246ICdmYSBmYS11bmRvJyxcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KGJsYWRlLm9yaWdFbnRpdHksIGJsYWRlLmN1cnJlbnRFbnRpdHkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjYW5FeGVjdXRlTWV0aG9kOiBpc0RpcnR5LFxuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uOiBibGFkZS51cGRhdGVQZXJtaXNzaW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgYmxhZGUudGF4VHlwZXMgPSBzZXR0aW5ncy5nZXRWYWx1ZXMoeyBpZDogJ1ZpcnRvQ29tbWVyY2UuQ29yZS5HZW5lcmFsLlRheFR5cGVzJyB9KTtcblxuICAgICAgICAgICAgYmxhZGUucmVmcmVzaCgpO1xuXG4gICAgICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlJykuY29udHJvbGxlcigndmlydG9Db21tZXJjZS5zaGlwcGluZ01vZHVsZS5zaGlwcGluZ01ldGhvZExpc3RDb250cm9sbGVyJywgWyckc2NvcGUnLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsICd2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlLnNoaXBwaW5nTWV0aG9kcycsIGZ1bmN0aW9uICgkc2NvcGUsIGJsYWRlTmF2aWdhdGlvblNlcnZpY2UsIHNoaXBwaW5nTWV0aG9kcykge1xuICAgIHZhciBibGFkZSA9ICRzY29wZS5ibGFkZTtcblxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVCbGFkZSgpIHtcbiAgICAgICAgYmxhZGUuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIGJsYWRlLmhlYWRJY29uID0gJ2ZhIGZhLWFyY2hpdmUnO1xuXG4gICAgICAgICRzY29wZS5zb3J0YWJsZU9wdGlvbnMgPSB7XG4gICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoZSwgdWkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5ibGFkZS5jdXJyZW50RW50aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJsYWRlLmN1cnJlbnRFbnRpdGllc1tpXS5wcmlvcml0eSA9IGkgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBheGlzOiAneScsXG4gICAgICAgICAgICBjdXJzb3I6IFwibW92ZVwiXG4gICAgICAgIH07XG5cbiAgICAgICAgYmxhZGUudG9vbGJhckNvbW1hbmRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwicGxhdGZvcm0uY29tbWFuZHMucmVmcmVzaFwiLCBpY29uOiAnZmEgZmEtcmVmcmVzaCcsXG4gICAgICAgICAgICAgICAgZXhlY3V0ZU1ldGhvZDogYmxhZGUucmVmcmVzaCxcbiAgICAgICAgICAgICAgICBjYW5FeGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgYmxhZGUucmVmcmVzaCgpO1xuICAgIH07XG5cbiAgICBibGFkZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICBzaGlwcGluZ01ldGhvZHMuc2VhcmNoKHtcbiAgICAgICAgICAgIHN0b3JlSWQ6IGJsYWRlLnN0b3JlSWRcbiAgICAgICAgfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgYmxhZGUuY3VycmVudEVudGl0aWVzID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgYmxhZGUuc2VsZWN0ZWRTaGlwcGluZ01ldGhvZHMgPSBfLmZpbmRXaGVyZShibGFkZS5jdXJyZW50RW50aXRpZXMsIHsgaXNBY3RpdmU6IHRydWUgfSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zZXRFcnJvcignRXJyb3IgJyArIGVycm9yLnN0YXR1cywgYmxhZGUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuc2VsZWN0Tm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZE5vZGVJZCA9IG5vZGUudHlwZU5hbWU7XG4gICAgICAgIHZhciBuZXdCbGFkZSA9IHtcbiAgICAgICAgICAgIGlkOiAnc2hpcHBpbmdNZXRob2REZXRhaWwnLFxuICAgICAgICAgICAgc2hpcHBpbmdNZXRob2Q6IG5vZGUsXG4gICAgICAgICAgICBzdG9yZUlkOiBibGFkZS5zdG9yZUlkLFxuICAgICAgICAgICAgc3VidGl0bGU6ICdzaGlwcGluZy5ibGFkZXMuc2hpcHBpbmctbWV0aG9kLWRldGFpbC5zdWJ0aXRsZScsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAndmlydG9Db21tZXJjZS5zaGlwcGluZ01vZHVsZS5zaGlwcGluZ01ldGhvZERldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5TaGlwcGluZykvU2NyaXB0cy9ibGFkZXMvc2hpcHBpbmdNZXRob2QtZGV0YWlsLnRwbC5odG1sJ1xuICAgICAgICB9O1xuICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgJHNjb3BlLmJsYWRlKTtcbiAgICB9O1xuXG4gICAgaW5pdGlhbGl6ZUJsYWRlKCk7XG5cbn1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLnNoaXBwaW5nTW9kdWxlJylcbiAgICAuZmFjdG9yeSgndmlydG9Db21tZXJjZS5zaGlwcGluZ01vZHVsZS5zaGlwcGluZ01ldGhvZHMnLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uICgkcmVzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnYXBpL3NoaXBwaW5nJywge30sIHtcbiAgICAgICAgICAgIGdldEFsbFJlZ2lzdGVyZWQ6IHsgbWV0aG9kOiAnR0VUJywgaXNBcnJheTogdHJ1ZSB9LFxuICAgICAgICAgICAgc2VhcmNoOiB7IG1ldGhvZDogJ1BPU1QnLCB1cmw6ICdhcGkvc2hpcHBpbmcvc2VhcmNoJyB9LFxuICAgICAgICAgICAgZ2V0OiB7IHVybDogJ2FwaS9zaGlwcGluZy86aWQnIH0sXG4gICAgICAgICAgICB1cGRhdGU6IHsgbWV0aG9kOiAnUFVUJyB9LFxuICAgICAgICB9KTtcbiAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgndmlydG9Db21tZXJjZS5zaGlwcGluZ01vZHVsZScpLmNvbnRyb2xsZXIoJ3ZpcnRvQ29tbWVyY2Uuc2hpcHBpbmdNb2R1bGUuc3RvcmVTaGlwcGluZ1dpZGdldENvbnRyb2xsZXInLCBbJyRzY29wZScsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZU5hdmlnYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSkge1xuICAgIHZhciBibGFkZSA9ICRzY29wZS5ibGFkZTtcblxuICAgICRzY29wZS5vcGVuQmxhZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuZXdCbGFkZSA9IHtcbiAgICAgICAgICAgIGlkOiBcInN0b3JlQ2hpbGRCbGFkZVwiLFxuICAgICAgICAgICAgc3RvcmVJZDogYmxhZGUuY3VycmVudEVudGl0eS5pZCxcbiAgICAgICAgICAgIHRpdGxlOiBibGFkZS50aXRsZSxcbiAgICAgICAgICAgIHN1YnRpdGxlOiAnc2hpcHBpbmcud2lkZ2V0cy5zdG9yZS1zaGlwcGluZy13aWRnZXQuYmxhZGUtc3VidGl0bGUnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2Uuc2hpcHBpbmdNb2R1bGUuc2hpcHBpbmdNZXRob2RMaXN0Q29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJ01vZHVsZXMvJChWaXJ0b0NvbW1lcmNlLlNoaXBwaW5nKS9TY3JpcHRzL2JsYWRlcy9zaGlwcGluZ01ldGhvZC1saXN0LnRwbC5odG1sJ1xuICAgICAgICB9O1xuICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgIH07XG59XSk7XG4iXSwic291cmNlUm9vdCI6IiJ9